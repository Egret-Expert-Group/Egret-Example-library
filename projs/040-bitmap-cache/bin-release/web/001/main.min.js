var Main=function(t){function e(){t.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var o=(__define,e),n=o.prototype;return n.onAddToStage=function(t){var e=new egret.ImageLoader;e.once(egret.Event.COMPLETE,this.imgLoadHandler,this),e.load("resource/cartoon-egret_02_small.png")},n.imgLoadHandler=function(t){var o=this;this._bmd=t.currentTarget.data,this._rectScope=new egret.Rectangle(0,0,this.stage.stageWidth,this.stage.stageHeight),this._vcCont=new Array;for(var n=0;n<e.NUM;++n){var i=new MotionSprite;i.anchorOffsetX=L.W_SHAPE/2,i.anchorOffsetY=L.H_SHAPE/2,i.x=this._rectScope.x+this._rectScope.width*Math.random(),i.y=this._rectScope.y+this._rectScope.height*Math.random(),i.factor=.8+.4*Math.random(),this._vcCont.push(i),this.addChild(i)}BatchContentFiller.reset(this._vcCont),BatchContentFiller.fill(this._vcCont),BatchContentFiller.autoAncher(this._vcCont),this._txInfo=new egret.TextField,this.addChild(this._txInfo),this._txInfo.size=28,this._txInfo.x=250,this._txInfo.y=10,this._txInfo.width=this.stage.stageWidth-260,this._txInfo.textAlign=egret.HorizontalAlign.LEFT,this._txInfo.textColor=0,this._txInfo.type=egret.TextFieldType.DYNAMIC,this._txInfo.lineSpacing=6,this._txInfo.multiline=!0,this._txInfo.touchEnabled=!0,this._txInfo.cacheAsBitmap=!0,this._bgInfo=new egret.Shape,this.addChildAt(this._bgInfo,this.numChildren-1),this._bgInfo.x=this._txInfo.x,this._bgInfo.y=this._txInfo.y,this._bgInfo.cacheAsBitmap=!0,this._nScaleBase=0,this._bCache=!1,this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){o.planRdmMotion()},this),this._txInfo.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stopImmediatePropagation(),o._bCache=!o._bCache;for(var e=o._vcCont.length-1;e>=0;e--)o._vcCont[e].cacheAsBitmap=o._bCache;o.updateInfo()},this),this.planRdmMotion(),this.stage.addEventListener(egret.Event.ENTER_FRAME,function(t){switch(o._iMotionMode){case MotionMode.ROT:for(var n=e.SCALE_BASE+Math.abs(Math.sin(o._nScaleBase+=.05))*e.SCALE_RANGE,i=o._vcCont.length-1;i>=0;i--)o._vcCont[i].rotation+=3*(i%2?1:-1)*o._vcCont[i].factor,o._vcCont[i].scaleX=o._vcCont[i].scaleY=n;break;case MotionMode.MOV:for(var a,i=o._vcCont.length-1;i>=0;i--)a=o._vcCont[i].x+3*(i%2?1:-1)*o._vcCont[i].factor,a<o._rectScope.left?a=o._rectScope.right:a>o._rectScope.right&&(a=o._rectScope.left),o._vcCont[i].x=a}},this)},n.planRdmMotion=function(){switch(void 0==arguments.callee.runyet?(arguments.callee.runyet=1,this._iMotionMode=Math.random()>.5?MotionMode.ROT:MotionMode.MOV):this._iMotionMode=(this._iMotionMode+1)%MotionMode.TOTAL,this.updateInfo(),this._iMotionMode){case MotionMode.ROT:for(var t=this._vcCont.length-1;t>=0;t--)this._vcCont[t].scaleX=this._vcCont[t].scaleY=e.SCALE_BASE;break;case MotionMode.MOV:for(var t=this._vcCont.length-1;t>=0;t--)this._vcCont[t].scaleX=this._vcCont[t].scaleY=e.SCALE_BASE+Math.random()*e.SCALE_RANGE}},n.updateInfo=function(){this._txInfo.text="轻触文字切换是否用位图缓存\n当前位图缓存："+(this._bCache?"启用\n还卡？换手机吧！":"关闭\n不卡只能说明机器太牛！")+"\n轻触舞台切换旋转缩放/平移\n当前运动："+["旋转缩放","平移"][this._iMotionMode],this._bgInfo.graphics.clear(),this._bgInfo.graphics.beginFill(16777215,.5),this._bgInfo.graphics.drawRect(0,0,this._txInfo.width,this._txInfo.height),this._bgInfo.graphics.endFill()},e.UNITS_PER_CONT=16,e.NUM=64,e.SCALE_BASE=.7,e.SCALE_RANGE=.6,e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var MotionSprite=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e);o.prototype;return e}(egret.Sprite);egret.registerClass(MotionSprite,"MotionSprite");var L=function(){function t(){}var e=(__define,t);e.prototype;return t.W_SHAPE=160,t.H_SHAPE=210,t}();egret.registerClass(L,"L");var MotionMode=function(){function t(){}var e=(__define,t);e.prototype;return t.ROT=0,t.MOV=1,t.TOTAL=2,t}();egret.registerClass(MotionMode,"MotionMode");var BatchContentFiller=function(){function t(){}var e=(__define,t);e.prototype;return t.fill=function(t){for(var e=0;e<Main.UNITS_PER_CONT;e++)this.prodRdmGraph(t,L.W_SHAPE,L.H_SHAPE)},t.prodRdmGraph=function(t,e,o){var n=Math.floor(2*Math.random()),i=(Math.floor(255*Math.random())<<16)+(Math.floor(255*Math.random())<<8)+Math.floor(255*Math.random()),a=(Math.floor(255*Math.random())<<16)+(Math.floor(255*Math.random())<<8)+Math.floor(255*Math.random()),r=20+10*Math.random(),h=30+20*Math.random(),s=20+10*Math.random(),c=L.W_SHAPE*Math.random(),_=L.H_SHAPE*Math.random();console.log("prodRdmGraph:",r,h,s,c,_,i,a,n);for(var d=t.length-1;d>=0;d--)switch(n){case 0:t[d].graphics.beginFill(i),t[d].graphics.drawRect(c-h/2,_-s/2,h,s),t[d].graphics.endFill(),console.log("prodRdmGraph: 画矩形",d);break;case 1:t[d].graphics.beginFill(i),t[d].graphics.drawCircle(c,_,r),t[d].graphics.endFill()}},t.autoAncher=function(t){for(var e=t.length-1;e>=0;e--)t[e].anchorOffsetX=t[e].width/2,t[e].anchorOffsetY=t[e].height/2,console.log("vcCont[i] 新锚点：",t[e].anchorOffsetX,t[e].anchorOffsetY)},t.reset=function(t){for(var e=t.length-1;e>=0;e--)t[e].graphics.clear(),t[e].removeChildren()},t}();egret.registerClass(BatchContentFiller,"BatchContentFiller");