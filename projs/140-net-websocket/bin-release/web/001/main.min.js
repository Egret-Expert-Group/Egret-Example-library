var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var s=(__define,e),i=s.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var s=(__define,e),i=s.prototype;return i.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/resource.json","resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.loadGroup("preload")},i.onResourceLoadComplete=function(t){this.init()},i.init=function(){this.socket=new egret.WebSocket,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.connect("echo.websocket.org",80),this.drawScene()},i.drawScene=function(){var t=new egret.Bitmap;t.texture=RES.getRes("background_png"),this.addChild(t),this.msgText=new egret.TextField,this.msgText.width=370,this.msgText.height=250,this.msgText.x=35,this.msgText.y=30,this.msgText.background=!0,this.msgText.backgroundColor=16777215,this.msgText.textColor=0,this.msgText.size=12,this.addChild(this.msgText),this.msgPushText=new egret.TextField,this.msgPushText.width=285,this.msgPushText.height=35,this.msgPushText.x=30,this.msgPushText.y=300,this.msgPushText.background=!0,this.msgPushText.backgroundColor=16777215,this.msgPushText.textColor=0,this.msgPushText.type=egret.TextFieldType.INPUT,this.addChild(this.msgPushText),this.pushMsgBtn=new egret.Sprite,this.pushMsgBtn.x=330,this.pushMsgBtn.y=300,this.addChild(this.pushMsgBtn),this.pushMsgBtn.touchEnabled=!0,this.pushMsgBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPushMsg,this);var e=new egret.Bitmap;e.texture=RES.getRes("sendbtn_png"),this.pushMsgBtn.addChild(e),console.log("draw scene!")},i.onReceiveMessage=function(t){var e=this.socket.readUTF();this.msgText.text+="\nServer:"+e},i.onSocketOpen=function(t){this.msgText.text+="\nThe connection is successful!"},i.onPushMsg=function(t){this.socket.writeUTF(this.msgPushText.text),this.socket.flush(),this.msgPushText.text=""},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");