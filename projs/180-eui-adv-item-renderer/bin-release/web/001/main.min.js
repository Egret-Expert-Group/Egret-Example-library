var AssetAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getAsset=function(e,t,i){function o(o){t.call(i,o,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?o(s):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getTheme=function(e,t,i,o){function s(e){t.call(o,e)}function n(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(o))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var i=(__define,t),o=i.prototype;return o.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},o.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var i=(__define,t),o=i.prototype;return o.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},o.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},o.onThemeLoadComplete=function(){console.log("theme load ok:",egret.getTimer()),this.isThemeLoadEnd=!0,this.createScene()},o.onResourceLoadComplete=function(e){switch(e.groupName){case"loading":console.log("loading ok:",egret.getTimer()),this.loadingView.parent&&this.loadingView.parent.removeChild(this.loadingView),this._trueLoadingUI=new TrueLoadingUI,this.loadPage("home");break;case"home":console.log("home ok:",egret.getTimer()),this.isResourceLoadEnd=!0,this.createScene()}},o.clearRESEvents=function(){},o.createScene=function(){console.log("createScene:",this.isThemeLoadEnd,this.isResourceLoadEnd),this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},o.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},o.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},o.onResourceProgress=function(e){switch(e.groupName){case"loading":this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal);break;default:this._trueLoadingUI.setProgress(e.itemsLoaded,e.itemsTotal)}},o.startCreateScene=function(){this._trueLoadingUI.parent&&this._trueLoadingUI.parent.removeChild(this._trueLoadingUI),this._goodsUI=new GoodsUI,this._goodsUI.horizontalCenter=0,this._txInfo=new egret.TextField,this.addChild(this._txInfo),this._txInfo.size=28,this._txInfo.x=50,this._txInfo.y=50,this._txInfo.textAlign=egret.HorizontalAlign.LEFT,this._txInfo.textColor=0,this._txInfo.type=egret.TextFieldType.DYNAMIC,this._txInfo.lineSpacing=6,this._txInfo.multiline=!0,this._txInfo.text="这是一个游戏中典型的物品列表实例",this.addChild(this._goodsUI),console.log("Main.ts this._homeUI:",this._goodsUI.width,this._goodsUI.height)},o.loadPage=function(e){switch(this.addChild(this._trueLoadingUI),this.idLoading=e,e){case"goods":RES.loadGroup("heros_goods");break;default:RES.loadGroup(e)}},t}(eui.UILayer);egret.registerClass(Main,"Main");var GoodsUI=function(e){function t(){e.call(this),this.addEventListener(eui.UIEvent.COMPLETE,this.uiCompHandler,this),this.skinName="resource/custom_skins/goodsUISkin.exml"}__extends(t,e);var i=(__define,t),o=i.prototype;return o.uiCompHandler=function(){console.log("		GoodsUI uiCompHandler");var e=[{icon:"goods01_png",goodsName:"魔法石",comment:"法力加成 +3"},{icon:"goods02_png",goodsName:"诅咒娃娃",comment:"咒术加成 +3"},{icon:"goods03_png",goodsName:"万圣戒指",comment:"敏捷加成 +3"},{icon:"goods04_png",goodsName:"斗篷",comment:"耐力加成 +3"},{icon:"goods05_png",goodsName:"鹅毛笔",comment:"精神加成 +3"},{icon:"goods06_png",goodsName:"血滴子",comment:"嗜血加成 +3"},{icon:"goods07_png",goodsName:"屠龙刀",comment:"力量加成 +5"}];this.listGoods.dataProvider=new eui.ArrayCollection(e),this.listGoods.itemRenderer=GoodsListIRSkin},o.createChildren=function(){e.prototype.createChildren.call(this)},t}(eui.Component);egret.registerClass(GoodsUI,"GoodsUI");var GoodsListIRSkin=function(e){function t(){e.call(this),this.skinName="goodsListIRSkin"}__extends(t,e);var i=(__define,t),o=i.prototype;return o.createChildren=function(){e.prototype.createChildren.call(this)},o.dataChanged=function(){},t}(eui.ItemRenderer);egret.registerClass(GoodsListIRSkin,"GoodsListIRSkin");var Toast=function(e){function t(i,o,s){var n=this;e.call(this),console.log("Toast:",i);var r=new egret.Bitmap(t._txtrToastBg);this.addChild(r);var a=new egret.TextField;a.multiline=!0,a.size=20,a.bold=!0,a.textColor=16777215,a.stroke=2,a.strokeColor=0,a.text=i,a.fontFamily="微软雅黑",a.textAlign=egret.HorizontalAlign.CENTER,a.width=.84*o,a.x=(t._txtrToastBg.textureWidth-a.width)/2,a.y=6,this.addChild(a),r.height=12+a.height,this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height,this.x=.5*o,this.y=.618*s,this.alpha=0,egret.Tween.get(this).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){n.parent&&n.parent.removeChild(n)})}__extends(t,e);var i=(__define,t);i.prototype;return t.init=function(e,t){console.log("Toast.init",t),this._cont=e,this._txtrToastBg=t},t.launch=function(e){if(this._cont){var i=new t(e,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(i)}},t}(egret.DisplayObjectContainer);egret.registerClass(Toast,"Toast");var TrueLoadingUI=function(e){function t(){var t=this;e.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){t.hasEventListener(egret.Event.ENTER_FRAME)&&t.removeEventListener(egret.Event.ENTER_FRAME,t.runLoading,t)},this),this.addEventListener(egret.Event.ADDED_TO_STAGE,function(){t.setProgress(0,1),t.addEventListener(egret.Event.ENTER_FRAME,t.runLoading,t)},this)}__extends(t,e);var i=(__define,t),o=i.prototype;return o.createChildren=function(){e.prototype.createChildren.call(this),this._loadingRun=new egret.Bitmap(RES.getRes("loading_run")),this.addChild(this._loadingRun),this._loadingRun.anchorOffsetX=.5*this._loadingRun.width,this._loadingRun.anchorOffsetY=.5*this._loadingRun.height,this._loadingRun.x=.5*this.stage.stageWidth,this._loadingRun.y=.5*this.stage.stageHeight,this._txProgress=new egret.TextField,this._txProgress.textAlign=egret.HorizontalAlign.CENTER,this._txProgress.verticalAlign=egret.VerticalAlign.MIDDLE,this._txProgress.x=.5*this.stage.stageWidth-100,this._txProgress.width=200,this._txProgress.y=.5*this.stage.stageHeight-100,this._txProgress.height=200,this._txProgress.size=14,this._txProgress.stroke=1,this._txProgress.strokeColor=0,this.addChild(this._txProgress)},o.runLoading=function(e){this._loadingRun.rotation+=3},o.setProgress=function(e,t){this._txProgress&&(this._txProgress.text=Math.round(e/t*100)+"%")},t}(eui.Group);egret.registerClass(TrueLoadingUI,"TrueLoadingUI");