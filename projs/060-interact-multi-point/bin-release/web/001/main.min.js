var Main=function(t){function i(){t.call(this),this.touchPoints={names:[]},this.distance=0,this.defAngle=0,this.touchCon=0,this._currentBirdRotation=0,this.c=.017453292,this.once(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(i,t);var e=(__define,i),h=e.prototype;return h.onAddToStage=function(t){var i=new egret.ImageLoader;i.once(egret.Event.COMPLETE,this.imgLoadHandler,this),i.load("resource/cartoon-egret_00_small.png")},h.imgLoadHandler=function(t){this._bird=new egret.Bitmap(t.currentTarget.data),this._bird.anchorOffsetX=this._bird.width/2,this._bird.anchorOffsetY=this._bird.height/2,this._bird.x=this.stage.stageWidth/2,this._bird.y=this.stage.stageHeight/2,this.addChild(this._bird),this.drawText(),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},h.mouseDown=function(t){egret.log("touch begin:"+t.touchPointID),null==this.touchPoints[t.touchPointID]&&(this.touchPoints[t.touchPointID]=new egret.Point(t.stageX,t.stageY),this.touchPoints.names.push(t.touchPointID)),this.touchCon++,2==this.touchCon&&(this.distance=this.getTouchDistance(),egret.log("distance:"+this.distance),this.defAngle=this.getTouchAngle(),egret.log("touch angle:"+this.defAngle),egret.log("bird angle:"+this._bird.rotation))},h.mouseMove=function(t){if(this.touchPoints[t.touchPointID].x=t.stageX,this.touchPoints[t.touchPointID].y=t.stageY,2==this.touchCon){var i=this.getTouchDistance();this._bird.scaleX=i/this.distance,this._bird.scaleY=this._bird.scaleX;var e=this.getTouchAngle();this._bird.rotation=this._currentBirdRotation+e-this.defAngle}},h.mouseUp=function(t){egret.log("touch end:"+t.touchPointID),delete this.touchPoints[t.touchPointID];var i=this.touchPoints.names.indexOf(t.touchPointID);i>=0&&this.touchPoints.names.splice(i,1),this.touchCon--,this._bird.width*=this._bird.scaleX,this._bird.height*=this._bird.scaleY,this._bird.scaleX=1,this._bird.scaleY=1,this._bird.anchorOffsetX=this._bird.width/2,this._bird.anchorOffsetY=this._bird.height/2,this._currentBirdRotation=this._bird.rotation,egret.log("bird size [wdith:"+this._bird.width.toFixed(1)+", height:"+this._bird.height.toFixed(1)+"]"),egret.log("bird angle:"+this._bird.rotation)},h.getTouchDistance=function(){var t=0,i=this.touchPoints.names;return t=egret.Point.distance(this.touchPoints[i[i.length-1]],this.touchPoints[i[i.length-2]])},h.getTouchAngle=function(){var t=0,i=this.touchPoints.names,e=this.touchPoints[i[i.length-1]],h=this.touchPoints[i[i.length-2]];return t=Math.atan2(e.y-h.y,e.x-h.x)/this.c},h.drawText=function(){this._txInfo=new egret.TextField,this.addChild(this._txInfo),this._txInfo.size=28,this._txInfo.x=50,this._txInfo.y=50,this._txInfo.textAlign=egret.HorizontalAlign.LEFT,this._txInfo.textColor=0,this._txInfo.type=egret.TextFieldType.DYNAMIC,this._txInfo.lineSpacing=6,this._txInfo.multiline=!0,this._txInfo.text="该示例需在移动端体验，使用双手指做捏合动作\n可缩放显示对象。双手指可旋转显示对象",this._bgInfo=new egret.Shape,this.addChildAt(this._bgInfo,this.numChildren-1),this._bgInfo.x=this._txInfo.x,this._bgInfo.y=this._txInfo.y,this._bgInfo.graphics.clear(),this._bgInfo.graphics.beginFill(16777215,.5),this._bgInfo.graphics.drawRect(0,0,this._txInfo.width,this._txInfo.height),this._bgInfo.graphics.endFill()},i}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");