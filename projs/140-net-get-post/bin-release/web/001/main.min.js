var AssetAdapter=function(){function e(){}var t=(__define,e),s=t.prototype;return s.getAsset=function(e,t,s){function r(r){t.call(s,r,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?r(n):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var s=(__define,t),r=s.prototype;return r.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},r.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var s=(__define,t),r=s.prototype;return r.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},r.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},r.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},r.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},r.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},r.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},r.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},r.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},r.startCreateScene=function(){var e=new eui.Button;e.label="Click!",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this);var t=new MainView;this.addChild(t),this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.OFF},r.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.UILayer);egret.registerClass(Main,"Main");var HttpRequestTest;!function(e){function t(e){var t=e.url?e.url:"http://httpbin.org/get",i=e.method?e.method:egret.HttpMethod.GET,o=e.header?e.header:{key:"Content-Type",value:"application/x-www-form-urlencoded"};console.log("url:"+t,"header:"+o);var a="";e.params&&(i===egret.HttpMethod.GET?t+="?"+n(e.params):a=n(e.params));var h=new egret.HttpRequest;h.responseType=e.response,h.open(t,i),h.setRequestHeader(o.key,o.value),h.send(a),h.addEventListener(egret.Event.COMPLETE,e.onSuccerss.bind(e.that),this),h.addEventListener(egret.IOErrorEvent.IO_ERROR,s,this),h.addEventListener(egret.ProgressEvent.PROGRESS,r,this)}function s(e){egret.warn("post error : "+e)}function r(e){egret.log("post progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")}function n(e){var t;for(var s in e)console.log("key:"+s+"value:"+e[s]),t?t+=s+"="+e[s]+"&":t=s+"="+e[s]+"&";return t.slice(0,-1)}e.httpRequest=t,e.paramsFormEncoded=n}(HttpRequestTest||(HttpRequestTest={}));var URLTest;!function(e){function t(){i();var e="http://httpbin.org/get",t=new egret.URLLoader;return t.dataFormat=egret.URLLoaderDataFormat.TEXT,t.addEventListener(egret.Event.COMPLETE,r,this),t.load(new egret.URLRequest(e)),this.statusGetLabel.text="正在向httpbin.org发送GET请求",this.statusGetLabel}function s(){i();var e="http://httpbin.org/post",t=new egret.URLLoader;t.dataFormat=egret.URLLoaderDataFormat.TEXT,t.addEventListener(egret.Event.COMPLETE,n,this);var s=new egret.URLRequest(e);return s.method=egret.URLRequestMethod.POST,s.data=new egret.URLVariables("test=ok"),t.load(s),this.statusGetLabel.text="正在向httpbin.org发送POST请求",this.statusGetLabel}function r(e){var t=e.target,s=t.data;this.statusGetLabel.text="获得GET响应! ",this.statusGetLabel.text+="\nGET响应: \n"+s.toString()}function n(e){var t=e.target,s=t.data;this.statusGetLabel.text="获得POST响应! ",this.statusGetLabel.text+="\nPOST响应: \n"+s.toString()}function i(){this.statusGetLabel=new egret.TextField,this.statusGetLabel.size=12,this.statusGetLabel.text="状态文本",this.statusGetLabel.x=10,this.statusGetLabel.y=10,this.statusGetLabel.width=430,this.statusGetLabel.height=430,this.statusGetLabel.textColor=255}e.testGet=t,e.testPost=s}(URLTest||(URLTest={}));var ThemeAdapter=function(){function e(){}var t=(__define,e),s=t.prototype;return s.getTheme=function(e,t,s,r){function n(e){t.call(r,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),s.call(r))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var MainView=function(e){function t(){e.call(this),this.testParams={key1:"value1",key2:"value2",key3:"value3"}}__extends(t,e);var s=(__define,t),r=s.prototype;return r.createChildren=function(){e.prototype.createChildren.call(this),this.skinName=new mainviewSkin,this.getButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetButton,this),this.postButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPostButton,this),this.onGetButton()},r.onGetButton=function(){console.log("onGetButton"),this.title.text="获得GET响应",this.argsLabel.text="Args";var e={};e.params=this.testParams,e.method=egret.HttpMethod.GET,e.url="http://httpbin.org/get",e.onSuccerss=this.onSuccess,e.that=this,HttpRequestTest.httpRequest(e),this.loading.alpha=1,this.loadingLabel.alpha=1,egret.Tween.get(this.loading,{loop:"true"}).to({rotation:"360"},2e3)},r.onPostButton=function(){console.log("onGetButton"),this.title.text="获得POST响应",this.argsLabel.text="Form";var e={};e.params=this.testParams,e.method=egret.HttpMethod.POST,e.url="http://httpbin.org/post",e.onSuccerss=this.onSuccess,e.that=this,HttpRequestTest.httpRequest(e),this.loading.alpha=1,this.loadingLabel.alpha=1,egret.Tween.get(this.loading,{loop:"true"}).to({rotation:"360"},2e3)},r.onSuccess=function(e){var t=e.currentTarget;egret.Tween.get(this.loading).to({alpha:0},1e3,egret.Ease.sineOut),egret.Tween.get(this.loadingLabel).to({alpha:0},1e3,egret.Ease.sineOut),console.log("here is main call"+this.testParams);var s=JSON.parse(t.response);egret.log("post data : ",s);var r=[];if(s.form)for(var n in s.form)r.push({label:n+" : "+s.form[n]});else for(var n in s.args)r.push({label:n+" : "+s.args[n]});this.args.itemRenderer=LabelRenderer,this.args.dataProvider=new eui.ArrayCollection(r);var i=[];for(n in s.headers)i.push({label:n+" : "+s.headers[n]});this.headers.itemRenderer=LabelRenderer,this.headers.dataProvider=new eui.ArrayCollection(i),this.originLabel.text=s.origin,this.urlLabel.text=s.url},t}(eui.Component);egret.registerClass(MainView,"MainView");var LabelRenderer=function(e){function t(){e.call(this),this.skinName=new itemDemoSkin,this.touchChildren=!0,this.addChild(this.labelDisplay)}__extends(t,e);var s=(__define,t),r=s.prototype;return r.dataChanged=function(){this.labelDisplay.text=this.data.label},t}(eui.ItemRenderer);egret.registerClass(LabelRenderer,"LabelRenderer");